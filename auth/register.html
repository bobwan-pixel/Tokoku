<!DOCTYPE html>
<html>
<head>
  <title>Registrasi Admin | Tokoku</title>
  <link rel="stylesheet" href="../css/auth.css">
</head>
<body>
  <div class="auth-container">
    <h1><i class="fas fa-user-shield"></i> Registrasi Admin</h1>
    <form id="registerForm">
      <input type="email" id="email" placeholder="Email admin" required>
      <input type="password" id="password" placeholder="Buat password" minlength="8" required>
      <input type="password" id="confirmPassword" placeholder="Konfirmasi password" required>
      <button type="submit"><i class="fas fa-save"></i> Daftarkan Admin</button>
    </form>
    <p class="notice">* Halaman ini hanya bisa diakses sekali</p>
  </div>

  <script src="../js/auth.js"></script>
  <script>
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;

      if (password !== confirmPassword) {
        return alert('Password tidak sama!');
      }

      try {
        const hashedPassword = await hashPassword(password);
        registerAdmin(email, hashedPassword);
        alert('Registrasi berhasil! Silahkan login');
        window.location.href = 'login.html';
      } catch (error) {
        alert(`Error: ${error.message}`);
      }
    });

    // Blokir akses jika admin sudah terdaftar
    if (localStorage.getItem('tokoku_admin_data')) {
      window.location.href = 'login.html';
    }
  </script>
</body>
</html>